## Hagemu is a GameBoy emulator

This is an attempt to write a GameBoy emulator in C99. This is a personal project to learn more about computers and emulation. Raylib is used to write the pixels and handle input. The end goal is to compile this project into WebAssembly using Emscripten. At the moment, this project is still a work in progress.

### Playable games (perhaps minor glitches)
- Tetris
- Dr. Mario
- Super Mario Land
- Metroid
- Zelda: Link's Awakening

### Progress Report
- [x] Implement CPU
  - [x] Parse opcodes
  - [x] Implement double registers
  - [x] Write functions for the opcodes
  - [x] Set flags in the f register
  - [x] Write the interrupt dispatch code
  - [x] Add a clock and timer interrupts
  - [x] Fix cycle timing of opcodes
  - [x] Cycle-correct memory reads/writes
  - [x] Pass Blargg's CPU test roms
    - [x] cpu_instrs test
    - [x] instr_timing test
    - [x] mem_timing test
    - [x] mem_timing_2 test
- [x] Implement PPU
  - [x] Display tiles from VRAM
  - [x] Write tiles to window with Raylib
  - [x] Draw the background layer
  - [x] Add window overlay
  - [x] Implement the scroll registers SCX and SCY
  - [x] Switch to a scanline based renderer
  - [x] Update the scroll registers per scanline
  - [x] Implement DMA transfers
  - [x] Add sprites
  - [x] Implement sprite attributes
  - [x] Support for 8x16 sprite mode
  - [x] Implement LCD STAT interrupts
  - [x] Respond to the LCD control register (except for disabling the PPU)
  - [x] Pass dmg-acid2 test rom
- [ ] Implement support for various Memory Bank Controller (MBC) chips
  - [x] MCB1 (Basic support)
  - [ ] MCB1 (Full support)
  - [x] MCB3 (except for Real Time Clock)
  - [x] Basic support for saving and loading .sav files
  - [ ] Real Time Clock support
- [ ] Minor fixes
  - [x] Separate the joypad logic from the Raylib library
  - [x] Add support for gamepads
  - [x] Test gamepad support
  - [x] Calculate the half-carry as (a ^ b ^ result) & 0x10
  - [x] Add 'inline' the CPU opcode functions
  - [x] Rewrite the f register as separate bools
  - [x] Fix glitch where a sprite partially clips if it's on the left or top border
  - [x] Fix bug where window X Position is less than 7
  - [ ] Pokemon Red has corrupted saves
  - [ ] Add option to blend frames
  - [ ] Emulate the timing of the DMA
  - [ ] Add support for disabling the PPU
  - [ ] Rewrite the CPU so that it can tick 1 m-cycle per call
  - [ ] Implement the STOP instruction
  - [ ] Test the HALT instruction
  - [ ] Rewrite the PPU using a pixel pusher renderer
  - [ ] Pass Blargg's interrupt_time test
  - [ ] Run the Mooneye Test Suite
  - [ ] Make a cool logo
  - [ ] Add a custom boot rom
- [ ] WebAssembly version
  - [x] Get the WebAssembly version working
  - [x] Add a simple front-end UI
  - [x] Upload to my website (https://uezu.dev/projects/hagemu)
  - [ ] Select file using a mobile browser
  - [ ] Touchscreen support
  - [ ] Download and upload save files
- [ ] Add a UI
  - [x] Drag and drop rom files onto the window
  - [ ] Add a custom bootrom
  - [ ] Select file using a file dialog window
  - [ ] Settings menu
    - [ ] Button mapping menu
    - [ ] Audio menu
    - [ ] Color palette menu
    - [ ] Save state menu
- [ ] Add the APU (Audio Processing Unit)
- [ ] Saving and loading save states
- [ ] Add GBC functionality
